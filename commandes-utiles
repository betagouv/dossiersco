# Active record

## Créer une migration

rake db:create_migration NAME=create_dossier_eleves_table

## Applique toutes les migration

rake db:migrate


## Applique le fichier seeds

rake db:seed

## Annule la dernière migration

rake db:rollback

## Pour tester une migration

irb(main):001:0> require_relative 'dossiersco_web'

Sortir d'irb pour refaire un require_relative


## Entre dans docker pour lancer rake

$docker ps
CONTAINER ID IMAGE COMMAND                   NAMES
1caf94c1e9f8 ruby "/bin/bash -lc 'bu..." ... dossiersco_app_1

$docker exec -it dossiersco_app_1 bash

$docker-compose exec app bash

## Consulter les logs par service (désentrelacer les logs)

docker-compose logs -f app

# Posgres

psql -U dossiersco

Sélectionne la base dossiersco :

\c dossiersco;

Puis montre les tables (dt pour Display Tables) :

\dt

postgres=# ALTER DATABASE dossiersco OWNER TO pblayo;
postgres=# ALTER USER dossiersco WITH PASSWORD 'new_password';


## Donne des droits

$ sudo -u postgres -i
postgres@host:~$ psql

postgres=# ALTER USER new_user CREATEDB;


# Sélectionne une version particulière de ruby

rbenv install 2.5.0
rbenv local 2.2.4
rbenv rehash (pour rendre disponibles de nouvelles commandes)
